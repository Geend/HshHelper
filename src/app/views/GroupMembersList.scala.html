@(group: Group, members: Seq[User], notMembers: Seq[User], addUserForm: Form[dtos.AddUserToGroupDTO])

@implicitFieldConstructor = @{ helper.FieldConstructor(BootstrapFieldConstructor.render)}

@userButton(member: User) = {
    @if(policy.Specification.CanRemoveGroupMember(extension.ContextArguments.getUser().get(), group, member)) {
        @helper.form(action = routes.GroupController.postRemoveMember(group.getId())){
            @helper.CSRF.formField
            <input type="hidden" name="userId" value="@member.getId()" />
            <button type="submit" class="btn btn-primary">Entfernen</button>
        }
    } else {
        <button class="btn btn-secondary" type="submit" disabled>Entfernen</button>
    }
}

@Main("Mitglieder von: " + group.name) {
    @functions.table(members.map(
        member => scala.collection.Map(
            "Benutzername" -> member.username,
            "" -> userButton(member).toString
    )))

    @if(policy.Specification.isAllowedToAddGroupMember(extension.ContextArguments.getUser().get(),
group)) {
        <h2>Benutzer hinzufuegen</h2>
        @helper.form(action = routes.GroupController.addMember(group.getId())) {
            @helper.CSRF.formField
            @helper.select(
                field = addUserForm("userId"),
                options = notMembers.map(user => user.id.toString -> user.username),
                '_label -> "Nutzer waehlen"
            )
            <button class="btn btn-primary" type="submit">Nutzer hinzufuegen</button>
        }
    }
}