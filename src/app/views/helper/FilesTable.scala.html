@import policyenforcement.Policy
@import policyenforcement.session.SessionManager.SessionInstance
@(files : Seq[File])

@classname(file : File) = {
    @if(file.getOwner.equals(SessionInstance().currentUser())) {
        class="ownFile"
    } else {
        class="thirdPartyFile"
    }
}

@permissions(file : File) = {
    @if(Policy.instance.CanReadFile(SessionInstance().currentUser(), file)) {
        Read
        @if(Policy.instance.CanWriteFile(SessionInstance().currentUser(), file)) {
            / Write
        }
    } else {
        @if(Policy.instance.CanWriteFile(SessionInstance().currentUser(), file)) {
            Write
        }
    }
}

@if(files.nonEmpty) {
    <table class="fileTable">
        <thead>
            <tr>
                <td class="name">Dateiname</td>
                <td>Kommentar</td>
                <td>Eigentümer</td>
                <td>Größe</td>
                <td>Zugriffsrechte</td>
            </tr>
        </thead>

        <tbody>
        @for(file <- files) {
            <tr @classname(file)>
                <td class="name"><b><a href="@routes.FileController.showFile(file.getFileId)">admin.txt</a></b></td>
                <td>@file.getComment</td>
                <td>@file.getOwner.getUsername</td>
                <td>@extension.FileSizeFormatter.humanReadableByteCount(file.getTotalSize)</td>
                <td>@permissions(file)</td>
            </tr>
        }
        </tbody>
    </table>

    <div class="fileTableLegend">
        <div class="title">Legende:</div>
        <div class="ownFile">Selbst geschriebene Dateien</div>
        <div class="thirdPartyFile">Von anderen geschriebene Dateien</div>
    </div>
} else {
    <div class="message error">
        Keine Dateien vorhanden!
    </div>
}