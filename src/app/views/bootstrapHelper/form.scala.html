@(route: play.api.mvc.Call, form: Form[_], fields: scala.collection.Map[String, views.bootstrapHelper.Input], button: Html, extraContent: Html*)

@implicitFieldConstructor = @{ helper.FieldConstructor(bootstrapHelper.BootstrapFieldConstructor.render)}

@if(form.hasGlobalErrors) {
    <p class="error">
    @for(error <- form.globalErrors) {
        <p>@error</p>
    }
    </p>
}

@helper.form(action = route) {
    @helper.CSRF.formField

    @for((k, v) <- fields) {
        @defining(if(form(k).hasErrors) "is-invalid" ) { hasErrors =>
            @v.typ match {
                case InputType.Hidden => {
                    <input type="@v.typ.toString" name="@k" value="@v.value.left.get"/>
                }
                case InputType.Select => {
                    @helper.select(
                        field = form(k),
                        options = v.value.right.get,
                        '_label -> v.label,
                        'class -> {"form-control " + hasErrors}
                    )
                }
                case InputType.File => {
                    @helper.input(form(k), '_label -> v.label) { (id, name, value, args) =>
                        <input class="form-control-file @hasErrors" type="@v.typ.toString()" name="@name" id="@id" @toHtmlArgs(args)>
                    }
                }
                case _ => {
                    @helper.input(form(k), '_label -> v.label) { (id, name, value, args) =>
                        <input class="form-control @hasErrors" type="@v.typ.toString" value="@value" name="@name" id="@id" placeholder="@v.placeholder" aria-describedby="@k.concat("Help")" @toHtmlArgs(args)>
                        <small id="@k.concat("Help")" class="form-text text-muted">@v.help</small>
                    }
                }
            }
        }
    }

    @extraContent

    @button
}
